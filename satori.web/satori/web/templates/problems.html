{% extends "templates/index.html" %}

{% block header %}

{{ form.media }}

{% endblock %}

{% block content %}

<form action="{% url contest_problems page_info.contest.id %}" method="POST">
<table>

{% for pinfo in problems %}
{% with pinfo.problem as problem %}
<tr>

<td>
{{pinfo.select}}
</td>

<td>
 {{ problem.code }} 
</td>

<td> 
<a href="{% url contest_problems_view page_info.contest.id problem.id %}">{{ problem.title }}</a><br/>
{% if problem.admin %}
{% if pinfo.visible %} Visible {% endif %}
{% if pinfo.submittable %} Submittable {% endif %}
{% endif %}
</td>

<td> 
{% if problem.admin %}
{% if pinfo.when_view %}

    {% if pinfo.when_view.start_on %}
    Appears on: {{ pinfo.when_view.start_on|date:"Y-m-d H:i:s" }}
    {% endif %}
<br/>    
    {% if pinfo.when_view.finish_on %}
    Hides on: {{ pinfo.when_view.finish_on|date:"Y-m-d H:i:s" }}
    {% endif %}
    
{% endif %}
{% endif %}
</td>

<td> 
{% if problem.admin %}
{% if pinfo.when_submit %}

    {% if pinfo.when_submit.start_on %}
    Submits start on: {{ pinfo.when_submit.start_on|date:"Y-m-d H:i:s" }}
    {% endif %}
<br/>    
    {% if pinfo.when_submit.finish_on %}
    Submits end on: {{ pinfo.when_submit.finish_on|date:"Y-m-d H:i:s" }}
    {% endif %}
    
{% endif %}
{% endif %}
</td>


<td>
{% if problem.admin %}
<a href={% url contest_problems_edit page_info.contest.id problem.id %}>Edit problem</a>
{% endif %}
</td>
</tr>

{% endwith %}
{% endfor %}
</table>

{% if any_admin %}
<h4>Mass edit</h4>
{{form.submitstart.errors}}
{{form.submitfinish.errors}}
<p>Set submission times from {{form.submitstart}} to {{form.submitfinish}}
{{form.viewauto}} Set view times automatically
<input type="submit" name="changesubmit" value="Change times"/>
</p>

{{form.viewstart.errors}}
{{form.viewfinish.errors}}
<p>Set view times from {{form.viewstart}} to {{form.viewfinish}}
<input type="submit" name="changeview" value="Change times"/>
</p>

<input type="submit" name="revokesubmit" value="Revoke submits"/>
<input type="submit" name="revokeview" value="Revoke submits AND hide problems"/>
</form>
{% endif %}

{% if page_info.contest.is_admin %}
<a href="{% url contest_problems_add page_info.contest.id %}">Add new problem</a>
{% endif %}
{% endblock %}