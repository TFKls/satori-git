{% extends "templates/index.html" %}
{% load url from future %}
{% load bootstrap3 %}

{% block header %}
<link rel="stylesheet" href="/files/results.css" />
{% endblock %}

{% block title %}
{{ page_info.contest.name }} - results
{% endblock %}

{% block content %}

<h4>Results</h4>

{% with results as table %}
{% include "pagination.html" %}
{% endwith %}

<div class="container-fluid">

<div class="col-md-9">
    <table class="table table-condensed">
    <thead>
        <tr>
            <th>Number</th>
        {% if page_info.contest_is_admin %}            
            <th>Contestant</th> 
        {% endif %}
            <th>Problem</th>
            <th>Status</th>
        </tr>
    </thead>
    <tbody>
        {% for row in results.rows %}
        <tr>
            <td><a href="{% url 'view_result' page_info.contest.id row.id %}">{{ row.id }}</a></td>
        {% if page_info.contest_is_admin %}            
            <td><a href="{{ row.contestant_link }}">{{ row.contestant }}</a></td>
        {% endif %}
            <td><a href="{{ row.problem_link }}">{{ row.problem }}</a></td>
            <td class="sta{{ row.status }}">{{ row.status }}</td>
        </tr>
        {% endfor %}
    </tbody>

    </table>
</div>    

<div class="col-md-3">
    <div class="panel panel-default">
    <div class="panel-heading">
    Filters <a href="{{results.pagedata.nofilterlink}}">{% bootstrap_icon "remove" %}</a>
    </div>
    <div class="panel-body">
        <form class="form form-vertical" role="form" action="{{ results.pagedata.nofilterlink }}" method="get">
            <div class="form-group">
            {% if page_info.contest_is_admin %}            
            <label for="results_contestant">Contestant: </label>
            <select class="form-control" name="results_contestant">
                <option value="">All contestants</option>
                {% for c in results.allcontestants %}
                <option value="{{ c.id }}" {% ifequal c.id|add:0 results.my_params.contestant|add:0 %} selected {% endifequal %}>
                    {{ c.name }}
                </option>
                {% endfor %}
            </select>
            {% endif %}

            <label for="results_problem">Problem: </label>
            <select class="form-control" name="results_problem">
                <option value="">All problems</option>
                {% for p in results.problems %}
                <option value="{{ p.problem_mapping.id }}" {% ifequal p.problem_mapping.id|add:0 results.my_params.problem|add:0 %} selected {% endifequal %}>
                    {{ p.problem_mapping.code }} &ndash; {{ p.problem_mapping.title }}

                </option>
                {% endfor %}
            </select>
            <label for="results_status">Status: </label>
            <input type="text" class="form-control" name="results_status" value="{{results.my_params.status}}"/>
            </div>
            
            <div class="form-group">
                <button type="submit" class="btn btn-default">Filter</button>
            </div>
        </form>
    </div>
    </div>
</div>
    
</div>


{% endblock %}

