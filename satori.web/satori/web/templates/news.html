{% extends "templates/index.html" %}
{% load url from future %}
{% load bootstrap3 %}
{% block title %}
{% if page_info.contest %}
{{ page_info.contest.name }}
{% else %}
Main page
{% endif %}
{% endblock %}

{% block content %}
<p> <span class="h3">News</span>
 
{% if page_info.contest_is_admin %}
<a class="btn btn-default btn-sm" href="{% url 'contest_news_add' page_info.contest.id %}">add</a>
{% endif %}

{% if not page_info.contest and page_info.is_admin %}
<a class="btn btn-default btn-sm" href="{% url 'news_add' %}">add</a>
{% endif %}
</p>

{% for msg in messages %}
<div class = "panel panel-default">
    <div class="panel-heading">
            {{ msg.subpage.name }} {{msg.subpage.date_created|date:"Y-m-d, H:i:s"}}
            {% if msg.is_admin %}
            {% if page_info.contest %}
                {% if msg.subpage.contest %}
                <a class="button button_small" href="{% url 'contest_news_edit' page_info.contest.id msg.subpage.id %}">Edit</a> 
                {% endif %}
            {% else %}
                <a class="button button_small" href="{% url 'news_edit' msg.subpage.id %}">Edit</a>
            {% endif %}
            {% endif %}
    </div>
            
    <div class="panel-body">
        {{ msg.html|safe }}
    </div>
</div>

    {% if can_edit %}
    <h5>Attachments</h5>
    <table>
        {% for afile in attachments %}
        <tr><td>
            <a href="{% url 'download_group' 'download' 'Subpage' subpage.id 'content_files' afile afile  %}">{{ afile }}</a>
        </td></tr>
        {% endfor %}
    </table>
    {% endif %}
{% endfor %}

{% endblock %}
